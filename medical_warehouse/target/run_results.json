{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-01-22T16:25:41.567317Z", "invocation_id": "47339d7f-530e-4d7a-8ad8-3f4ad947d01e", "invocation_started_at": "2026-01-22T16:25:28.641195Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T16:25:38.238551Z", "completed_at": "2026-01-22T16:25:38.267243Z"}, {"name": "execute", "started_at": "2026-01-22T16:25:38.269245Z", "completed_at": "2026-01-22T16:25:38.997313Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7627584934234619, "adapter_response": {"_message": "SELECT 1096", "code": "SELECT", "rows_affected": 1096}, "message": "SELECT 1096", "failures": null, "unique_id": "model.medical_warehouse.dim_dates", "compiled": true, "compiled_code": "\n\nWITH date_series AS (\n    SELECT \n        generate_series(\n            '2024-01-01'::date,\n            '2026-12-31'::date,\n            '1 day'::interval\n        ) as date_day\n)\n\nSELECT \n    TO_CHAR(date_day, 'YYYYMMDD')::integer as date_key,\n    date_day as full_date,\n    EXTRACT(YEAR FROM date_day) as year,\n    EXTRACT(QUARTER FROM date_day) as quarter,\n    EXTRACT(MONTH FROM date_day) as month,\n    TO_CHAR(date_day, 'Month') as month_name,\n    EXTRACT(WEEK FROM date_day) as week_of_year,\n    EXTRACT(DAY FROM date_day) as day_of_month,\n    EXTRACT(DOW FROM date_day) as day_of_week,\n    CASE \n        WHEN EXTRACT(DOW FROM date_day) = 0 THEN 'Sunday'\n        WHEN EXTRACT(DOW FROM date_day) = 1 THEN 'Monday'\n        WHEN EXTRACT(DOW FROM date_day) = 2 THEN 'Tuesday'\n        WHEN EXTRACT(DOW FROM date_day) = 3 THEN 'Wednesday'\n        WHEN EXTRACT(DOW FROM date_day) = 4 THEN 'Thursday'\n        WHEN EXTRACT(DOW FROM date_day) = 5 THEN 'Friday'\n        WHEN EXTRACT(DOW FROM date_day) = 6 THEN 'Saturday'\n    END as day_name,\n    CASE \n        WHEN EXTRACT(DOW FROM date_day) IN (0, 6) THEN TRUE \n        ELSE FALSE \n    END as is_weekend\nFROM date_series", "relation_name": "\"medical_warehouse\".\"analytics_marts\".\"dim_dates\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T16:25:39.020316Z", "completed_at": "2026-01-22T16:25:39.034319Z"}, {"name": "execute", "started_at": "2026-01-22T16:25:39.036316Z", "completed_at": "2026-01-22T16:25:39.738322Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7260024547576904, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.medical_warehouse.stg_telegram_messages", "compiled": true, "compiled_code": "\n\nSELECT \n    message_id,\n    channel_name,\n    message_date::timestamp,\n    message_text,\n    has_media,\n    image_path,\n    COALESCE(views, 0) as views,\n    COALESCE(forwards, 0) as forwards\nFROM \"medical_warehouse\".\"raw\".\"telegram_messages\"\nWHERE message_text IS NOT NULL", "relation_name": "\"medical_warehouse\".\"analytics_staging\".\"stg_telegram_messages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T16:25:39.778322Z", "completed_at": "2026-01-22T16:25:39.791313Z"}, {"name": "execute", "started_at": "2026-01-22T16:25:39.793315Z", "completed_at": "2026-01-22T16:25:40.344318Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5739977359771729, "adapter_response": {"_message": "SELECT 5", "code": "SELECT", "rows_affected": 5}, "message": "SELECT 5", "failures": null, "unique_id": "model.medical_warehouse.dim_channels", "compiled": true, "compiled_code": "\n\nWITH channel_stats AS (\n    SELECT \n        channel_name,\n        COUNT(*) as total_posts,\n        MIN(message_date) as first_post_date,\n        MAX(message_date) as last_post_date,\n        AVG(views)::numeric(10,2) as avg_views,\n        AVG(forwards)::numeric(10,2) as avg_forwards,\n        SUM(CASE WHEN image_path IS NOT NULL THEN 1 ELSE 0 END) as total_images\n    FROM \"medical_warehouse\".\"analytics_staging\".\"stg_telegram_messages\"\n    GROUP BY channel_name\n)\n\nSELECT \n    ROW_NUMBER() OVER (ORDER BY channel_name) as channel_key,\n    channel_name,\n    CASE \n        WHEN channel_name ILIKE '%pharma%' THEN 'Pharmaceutical'\n        WHEN channel_name ILIKE '%cosmetic%' THEN 'Cosmetics'\n        WHEN channel_name ILIKE '%med%' OR channel_name ILIKE '%medical%' THEN 'Medical'\n        WHEN channel_name ILIKE '%health%' OR channel_name ILIKE '%info%' THEN 'Health Information'\n        ELSE 'General Health'\n    END as channel_type,\n    first_post_date,\n    last_post_date,\n    total_posts,\n    avg_views,\n    avg_forwards,\n    total_images,\n    -- SIMPLIFIED: Remove rounding or use CAST\n    (total_images::float / NULLIF(total_posts, 0) * 100)::numeric(10,2) as image_percentage\nFROM channel_stats\nORDER BY total_posts DESC", "relation_name": "\"medical_warehouse\".\"analytics_marts\".\"dim_channels\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T16:25:40.378315Z", "completed_at": "2026-01-22T16:25:40.393321Z"}, {"name": "execute", "started_at": "2026-01-22T16:25:40.395317Z", "completed_at": "2026-01-22T16:25:40.966323Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5939981937408447, "adapter_response": {"_message": "SELECT 250", "code": "SELECT", "rows_affected": 250}, "message": "SELECT 250", "failures": null, "unique_id": "model.medical_warehouse.fct_messages", "compiled": true, "compiled_code": "\n\nWITH messages AS (\n    SELECT \n        message_id,\n        channel_name,\n        message_date,\n        message_text,\n        LENGTH(message_text) as message_length,\n        views,\n        forwards,\n        CASE WHEN image_path IS NOT NULL THEN TRUE ELSE FALSE END as has_image\n    FROM \"medical_warehouse\".\"analytics_staging\".\"stg_telegram_messages\"\n)\n\nSELECT \n    ROW_NUMBER() OVER (ORDER BY m.message_id) as message_key,\n    m.message_id,\n    c.channel_key,\n    d.date_key,\n    m.message_text,\n    m.message_length,\n    m.views,\n    m.forwards,\n    m.has_image\nFROM messages m\nLEFT JOIN \"medical_warehouse\".\"analytics_marts\".\"dim_channels\" c ON m.channel_name = c.channel_name\nLEFT JOIN \"medical_warehouse\".\"analytics_marts\".\"dim_dates\" d ON DATE(m.message_date) = d.full_date", "relation_name": "\"medical_warehouse\".\"analytics_marts\".\"fct_messages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-22T16:25:40.999316Z", "completed_at": "2026-01-22T16:25:41.051319Z"}, {"name": "execute", "started_at": "2026-01-22T16:25:41.054321Z", "completed_at": "2026-01-22T16:25:41.348316Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.355999231338501, "adapter_response": {"_message": "SELECT 194", "code": "SELECT", "rows_affected": 194}, "message": "SELECT 194", "failures": null, "unique_id": "model.medical_warehouse.fct_image_detections", "compiled": true, "compiled_code": "\n\nWITH image_detections AS (\n    SELECT \n        y.message_id,\n        y.channel_name,\n        y.detected_objects,\n        y.object_count,\n        y.primary_object,\n        y.primary_confidence,\n        y.image_category,\n        y.has_person,\n        y.has_container,\n        y.has_medical\n    FROM image_analysis.yolo_detections y\n),\n\njoined_data AS (\n    SELECT \n        f.message_key,\n        f.channel_key,\n        f.date_key,\n        f.views,\n        f.forwards,\n        f.has_image as has_image_in_message,\n        i.detected_objects,\n        i.object_count,\n        i.primary_object,\n        i.primary_confidence,\n        i.image_category,\n        i.has_person,\n        i.has_container,\n        i.has_medical,\n        CASE \n            WHEN i.image_category = 'promotional' THEN 'Person + Product'\n            WHEN i.image_category = 'product_display' THEN 'Product Only'\n            WHEN i.image_category = 'lifestyle' THEN 'Person Only'\n            ELSE 'Other'\n        END as image_category_description\n    FROM \"medical_warehouse\".\"analytics_marts\".\"fct_messages\" f\n    LEFT JOIN image_detections i ON f.message_id = i.message_id\n    WHERE f.has_image = TRUE  -- Only messages with images\n)\n\nSELECT \n    ROW_NUMBER() OVER (ORDER BY message_key) as image_analysis_key,\n    *\nFROM joined_data", "relation_name": "\"medical_warehouse\".\"analytics_marts\".\"fct_image_detections\"", "batch_results": null}], "elapsed_time": 6.144765138626099, "args": {"print": true, "require_ref_searches_node_package_before_root": false, "show_resource_report": false, "partial_parse": true, "macro_debugging": false, "partial_parse_file_diff": true, "defer": false, "send_anonymous_usage_stats": true, "use_colors_file": true, "quiet": false, "log_level_file": "debug", "strict_mode": false, "state_modified_compare_more_unrendered_values": false, "log_format_file": "debug", "write_json": true, "use_colors": true, "log_level": "info", "state_modified_compare_vars": false, "introspect": true, "indirect_selection": "eager", "empty": false, "exclude": [], "favor_state": false, "populate_cache": true, "log_path": "C:\\Users\\DELL\\Desktop\\10X-Academy\\10academy-week8\\Medical-Telegram-Warehouse\\medical_warehouse\\logs", "require_all_warnings_handled_by_warn_error": false, "require_generic_test_arguments_property": true, "use_fast_test_edges": false, "require_yaml_configuration_for_mf_time_spines": false, "upload_to_artifacts_ingest_api": false, "require_unique_project_resource_names": false, "profiles_dir": "C:\\Users\\DELL\\.dbt", "source_freshness_run_project_hooks": true, "show_all_deprecations": false, "printer_width": 80, "which": "run", "static_parser": true, "require_explicit_package_overrides_for_builtin_materializations": true, "validate_macro_args": false, "log_format": "default", "log_file_max_bytes": 10485760, "version_check": true, "require_batched_execution_for_custom_microbatch_strategy": false, "require_nested_cumulative_type_params": false, "vars": {}, "project_dir": "C:\\Users\\DELL\\Desktop\\10X-Academy\\10academy-week8\\Medical-Telegram-Warehouse\\medical_warehouse", "invocation_command": "dbt run", "require_resource_names_without_spaces": true, "cache_selected_only": false, "skip_nodes_if_on_run_start_fails": false, "select": [], "warn_error_options": {"error": [], "warn": [], "silence": []}}}