{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.2", "generated_at": "2026-01-18T20:35:57.218237Z", "invocation_id": "e9c6aacc-1c8e-445a-a289-a010f2f0fb1e", "invocation_started_at": "2026-01-18T20:35:54.178801Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T20:35:56.906887Z", "completed_at": "2026-01-18T20:35:56.955526Z"}, {"name": "execute", "started_at": "2026-01-18T20:35:56.956524Z", "completed_at": "2026-01-18T20:35:56.956524Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05263400077819824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.medical_warehouse.__init__", "compiled": true, "compiled_code": "\n\n\n# This part is user provided model code\n# you will need to copy the next section to run the code\n# COMMAND ----------\n# this part is dbt logic for get ref work, do not modify\n\ndef ref(*args, **kwargs):\n    refs = {}\n    key = '.'.join(args)\n    version = kwargs.get(\"v\") or kwargs.get(\"version\")\n    if version:\n        key += f\".v{version}\"\n    dbt_load_df_function = kwargs.get(\"dbt_load_df_function\")\n    return dbt_load_df_function(refs[key])\n\n\ndef source(*args, dbt_load_df_function):\n    sources = {}\n    key = '.'.join(args)\n    return dbt_load_df_function(sources[key])\n\n\nconfig_dict = {}\n\n\nclass config:\n    def __init__(self, *args, **kwargs):\n        pass\n\n    @staticmethod\n    def get(key, default=None):\n        return config_dict.get(key, default)\n\nclass this:\n    \"\"\"dbt.this() or dbt.this.identifier\"\"\"\n    database = \"medical_warehouse\"\n    schema = \"analytics_staging\"\n    identifier = \"__init__\"\n    \n    def __repr__(self):\n        return '\"medical_warehouse\".\"analytics_staging\".\"__init__\"'\n\n\nclass dbtObj:\n    def __init__(self, load_df_function) -> None:\n        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)\n        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)\n        self.config = config\n        self.this = this()\n        self.is_incremental = False\n\n# COMMAND ----------\n\n\n", "relation_name": "\"medical_warehouse\".\"analytics_staging\".\"__init__\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T20:35:56.964529Z", "completed_at": "2026-01-18T20:35:56.972461Z"}, {"name": "execute", "started_at": "2026-01-18T20:35:56.974464Z", "completed_at": "2026-01-18T20:35:56.974464Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012934207916259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.medical_warehouse.dim_dates", "compiled": true, "compiled_code": "\n\nWITH date_series AS (\n    SELECT \n        generate_series(\n            '2024-01-01'::date,\n            '2026-12-31'::date,\n            '1 day'::interval\n        ) as date_day\n)\n\nSELECT \n    TO_CHAR(date_day, 'YYYYMMDD')::integer as date_key,\n    date_day as full_date,\n    EXTRACT(YEAR FROM date_day) as year,\n    EXTRACT(QUARTER FROM date_day) as quarter,\n    EXTRACT(MONTH FROM date_day) as month,\n    TO_CHAR(date_day, 'Month') as month_name,\n    EXTRACT(WEEK FROM date_day) as week_of_year,\n    EXTRACT(DAY FROM date_day) as day_of_month,\n    EXTRACT(DOW FROM date_day) as day_of_week,\n    CASE \n        WHEN EXTRACT(DOW FROM date_day) = 0 THEN 'Sunday'\n        WHEN EXTRACT(DOW FROM date_day) = 1 THEN 'Monday'\n        WHEN EXTRACT(DOW FROM date_day) = 2 THEN 'Tuesday'\n        WHEN EXTRACT(DOW FROM date_day) = 3 THEN 'Wednesday'\n        WHEN EXTRACT(DOW FROM date_day) = 4 THEN 'Thursday'\n        WHEN EXTRACT(DOW FROM date_day) = 5 THEN 'Friday'\n        WHEN EXTRACT(DOW FROM date_day) = 6 THEN 'Saturday'\n    END as day_name,\n    CASE \n        WHEN EXTRACT(DOW FROM date_day) IN (0, 6) THEN TRUE \n        ELSE FALSE \n    END as is_weekend\nFROM date_series", "relation_name": "\"medical_warehouse\".\"analytics_marts\".\"dim_dates\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T20:35:56.982462Z", "completed_at": "2026-01-18T20:35:56.988462Z"}, {"name": "execute", "started_at": "2026-01-18T20:35:56.990463Z", "completed_at": "2026-01-18T20:35:56.990463Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011000633239746094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.medical_warehouse.stg_telegram_messages", "compiled": true, "compiled_code": "\n\nSELECT \n    message_id,\n    channel_name,\n    message_date::timestamp,\n    message_text,\n    has_media,\n    image_path,\n    COALESCE(views, 0) as views,\n    COALESCE(forwards, 0) as forwards\nFROM \"medical_warehouse\".\"raw\".\"telegram_messages\"\nWHERE message_text IS NOT NULL", "relation_name": "\"medical_warehouse\".\"analytics_staging\".\"stg_telegram_messages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T20:35:56.996464Z", "completed_at": "2026-01-18T20:35:57.026957Z"}, {"name": "execute", "started_at": "2026-01-18T20:35:57.028957Z", "completed_at": "2026-01-18T20:35:57.028957Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03449440002441406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.source_not_null_raw_telegram_messages_message_id.ae19ac6c99", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect message_id\nfrom \"medical_warehouse\".\"raw\".\"telegram_messages\"\nwhere message_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T20:35:57.035004Z", "completed_at": "2026-01-18T20:35:57.050726Z"}, {"name": "execute", "started_at": "2026-01-18T20:35:57.051727Z", "completed_at": "2026-01-18T20:35:57.051727Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01972508430480957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.source_unique_raw_telegram_messages_message_id.63b3712cc3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    message_id as unique_field,\n    count(*) as n_records\n\nfrom \"medical_warehouse\".\"raw\".\"telegram_messages\"\nwhere message_id is not null\ngroup by message_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T20:35:57.060726Z", "completed_at": "2026-01-18T20:35:57.073458Z"}, {"name": "execute", "started_at": "2026-01-18T20:35:57.074457Z", "completed_at": "2026-01-18T20:35:57.074457Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016730308532714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.medical_warehouse.dim_channels", "compiled": true, "compiled_code": "\n\nWITH channel_stats AS (\n    SELECT \n        channel_name,\n        COUNT(*) as total_posts,\n        MIN(message_date) as first_post_date,\n        MAX(message_date) as last_post_date,\n        AVG(views)::numeric(10,2) as avg_views,\n        AVG(forwards)::numeric(10,2) as avg_forwards,\n        SUM(CASE WHEN image_path IS NOT NULL THEN 1 ELSE 0 END) as total_images\n    FROM \"medical_warehouse\".\"analytics_staging\".\"stg_telegram_messages\"\n    GROUP BY channel_name\n)\n\nSELECT \n    ROW_NUMBER() OVER (ORDER BY channel_name) as channel_key,\n    channel_name,\n    CASE \n        WHEN channel_name ILIKE '%pharma%' THEN 'Pharmaceutical'\n        WHEN channel_name ILIKE '%cosmetic%' THEN 'Cosmetics'\n        WHEN channel_name ILIKE '%med%' OR channel_name ILIKE '%medical%' THEN 'Medical'\n        WHEN channel_name ILIKE '%health%' OR channel_name ILIKE '%info%' THEN 'Health Information'\n        ELSE 'General Health'\n    END as channel_type,\n    first_post_date,\n    last_post_date,\n    total_posts,\n    avg_views,\n    avg_forwards,\n    total_images,\n    -- SIMPLIFIED: Remove rounding or use CAST\n    (total_images::float / NULLIF(total_posts, 0) * 100)::numeric(10,2) as image_percentage\nFROM channel_stats\nORDER BY total_posts DESC", "relation_name": "\"medical_warehouse\".\"analytics_marts\".\"dim_channels\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T20:35:57.081457Z", "completed_at": "2026-01-18T20:35:57.088456Z"}, {"name": "execute", "started_at": "2026-01-18T20:35:57.089457Z", "completed_at": "2026-01-18T20:35:57.089457Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013003349304199219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.assert_positive_views", "compiled": true, "compiled_code": "-- Test to ensure view counts are non-negative\nSELECT \n    message_id,\n    views\nFROM \"medical_warehouse\".\"analytics_staging\".\"stg_telegram_messages\"\nWHERE views < 0", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T20:35:57.095457Z", "completed_at": "2026-01-18T20:35:57.106556Z"}, {"name": "execute", "started_at": "2026-01-18T20:35:57.108556Z", "completed_at": "2026-01-18T20:35:57.108556Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017098426818847656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.medical_warehouse.fct_messages", "compiled": true, "compiled_code": "\n\nWITH messages AS (\n    SELECT \n        message_id,\n        channel_name,\n        message_date,\n        message_text,\n        LENGTH(message_text) as message_length,\n        views,\n        forwards,\n        CASE WHEN image_path IS NOT NULL THEN TRUE ELSE FALSE END as has_image\n    FROM \"medical_warehouse\".\"analytics_staging\".\"stg_telegram_messages\"\n)\n\nSELECT \n    ROW_NUMBER() OVER (ORDER BY m.message_id) as message_key,\n    m.message_id,\n    c.channel_key,\n    d.date_key,\n    m.message_text,\n    m.message_length,\n    m.views,\n    m.forwards,\n    m.has_image\nFROM messages m\nLEFT JOIN \"medical_warehouse\".\"analytics_marts\".\"dim_channels\" c ON m.channel_name = c.channel_name\nLEFT JOIN \"medical_warehouse\".\"analytics_marts\".\"dim_dates\" d ON DATE(m.message_date) = d.full_date", "relation_name": "\"medical_warehouse\".\"analytics_marts\".\"fct_messages\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T20:35:57.116367Z", "completed_at": "2026-01-18T20:35:57.126362Z"}, {"name": "execute", "started_at": "2026-01-18T20:35:57.127363Z", "completed_at": "2026-01-18T20:35:57.127363Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013807296752929688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_dim_channels_channel_key.0d11906ab0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect channel_key\nfrom \"medical_warehouse\".\"analytics_marts\".\"dim_channels\"\nwhere channel_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T20:35:57.131360Z", "completed_at": "2026-01-18T20:35:57.146385Z"}, {"name": "execute", "started_at": "2026-01-18T20:35:57.148383Z", "completed_at": "2026-01-18T20:35:57.148383Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01902318000793457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.unique_dim_channels_channel_key.e02e6f1e56", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    channel_key as unique_field,\n    count(*) as n_records\n\nfrom \"medical_warehouse\".\"analytics_marts\".\"dim_channels\"\nwhere channel_key is not null\ngroup by channel_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T20:35:57.153760Z", "completed_at": "2026-01-18T20:35:57.160760Z"}, {"name": "execute", "started_at": "2026-01-18T20:35:57.161760Z", "completed_at": "2026-01-18T20:35:57.161760Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009996891021728516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.not_null_fct_messages_message_key.6ec13fb5c7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect message_key\nfrom \"medical_warehouse\".\"analytics_marts\".\"fct_messages\"\nwhere message_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T20:35:57.167923Z", "completed_at": "2026-01-18T20:35:57.181982Z"}, {"name": "execute", "started_at": "2026-01-18T20:35:57.183142Z", "completed_at": "2026-01-18T20:35:57.183142Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01727294921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.relationships_fct_messages_channel_key__channel_key__ref_dim_channels_.a84e299b5a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select channel_key as from_field\n    from \"medical_warehouse\".\"analytics_marts\".\"fct_messages\"\n    where channel_key is not null\n),\n\nparent as (\n    select channel_key as to_field\n    from \"medical_warehouse\".\"analytics_marts\".\"dim_channels\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T20:35:57.187143Z", "completed_at": "2026-01-18T20:35:57.196147Z"}, {"name": "execute", "started_at": "2026-01-18T20:35:57.198145Z", "completed_at": "2026-01-18T20:35:57.198145Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012001991271972656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.relationships_fct_messages_date_key__date_key__ref_dim_dates_.0f5b971d32", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select date_key as from_field\n    from \"medical_warehouse\".\"analytics_marts\".\"fct_messages\"\n    where date_key is not null\n),\n\nparent as (\n    select date_key as to_field\n    from \"medical_warehouse\".\"analytics_marts\".\"dim_dates\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-01-18T20:35:57.204146Z", "completed_at": "2026-01-18T20:35:57.210232Z"}, {"name": "execute", "started_at": "2026-01-18T20:35:57.210232Z", "completed_at": "2026-01-18T20:35:57.210232Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009083747863769531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.medical_warehouse.unique_fct_messages_message_key.0dbebefdcb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    message_key as unique_field,\n    count(*) as n_records\n\nfrom \"medical_warehouse\".\"analytics_marts\".\"fct_messages\"\nwhere message_key is not null\ngroup by message_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.8484182357788086, "args": {"macro_debugging": false, "require_resource_names_without_spaces": true, "show_all_deprecations": false, "send_anonymous_usage_stats": true, "log_path": "C:\\Users\\DELL\\Desktop\\10X-Academy\\10academy-week8\\Medical-Telegram-Warehouse\\medical_warehouse\\logs", "populate_cache": true, "state_modified_compare_more_unrendered_values": false, "use_colors": true, "log_level": "info", "require_batched_execution_for_custom_microbatch_strategy": false, "require_unique_project_resource_names": false, "vars": {}, "log_file_max_bytes": 10485760, "cache_selected_only": false, "partial_parse": true, "state_modified_compare_vars": false, "require_generic_test_arguments_property": true, "select": [], "source_freshness_run_project_hooks": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "compile": true, "project_dir": "C:\\Users\\DELL\\Desktop\\10X-Academy\\10academy-week8\\Medical-Telegram-Warehouse\\medical_warehouse", "use_colors_file": true, "validate_macro_args": false, "exclude": [], "empty_catalog": false, "log_format_file": "debug", "quiet": false, "upload_to_artifacts_ingest_api": false, "profiles_dir": "C:\\Users\\DELL\\.dbt", "log_format": "default", "write_json": true, "static": false, "skip_nodes_if_on_run_start_fails": false, "require_all_warnings_handled_by_warn_error": false, "static_parser": true, "use_fast_test_edges": false, "show_resource_report": false, "invocation_command": "dbt docs generate", "require_yaml_configuration_for_mf_time_spines": false, "introspect": true, "which": "generate", "require_nested_cumulative_type_params": false, "favor_state": false, "partial_parse_file_diff": true, "indirect_selection": "eager", "defer": false, "require_ref_searches_node_package_before_root": false, "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "strict_mode": false, "version_check": true, "printer_width": 80, "print": true}}